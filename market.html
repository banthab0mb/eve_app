<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <title>EVE Tools - Home</title>
  <link rel="stylesheet" href="home.css">
</head>
<body>
  <header>
  <h1 class="app-title"><a href="index.html">EVE Tools</a></h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="systemSearch.html">System Lookup</a>
    <a href="route.html">Route Planner</a>
    <a href="playerLookup.html">Lookup</a>
    <a href="about.html">About</a>
  </nav>
  <div id="onlineCounter">Loading...</div>
  <div id="eveTime">--:--</div>
</header>

  <main>
    <div class="controls">
      <input type="text" id="itemInput" placeholder="Enter item name" autocomplete="off">
      <div id="suggestions" class="suggestions"></div>
      <select id="regionSelect" class="styled-select"></select>
      <select id="orderTypeSelect">
        <option value="sell" selected>Sell Orders</option>
        <option value="buy">Buy Orders</option>
      </select>
      <button id="searchBtn">Search</button>
    </div>

    <div id="results">
      <div class="item-header">
        <img id="itemImage" src="" alt="Item Icon" style="width:64px;height:64px;">
        <h2 id="itemName">Select an item</h2>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <button class="tab-btn active" data-tab="ordersTab">Orders</button>
        <button class="tab-btn" data-tab="chartTab">Price History</button>
      </div>

      <!-- Orders Tab -->
      <div class="tab-content active" id="ordersTab">
        <div class="orders-list">
          <h3>Buy Orders</h3>
          <table id="buyOrdersTable" class="sortable">
            <thead>
              <tr>
                <th data-sort="number">Price</th>
                <th data-sort="number">Volume</th>
                <th data-sort="string">Location</th>
                <th data-sort="string">Expires</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="orders-list">
          <h3>Sell Orders</h3>
          <table id="sellOrdersTable" class="sortable">
            <thead>
              <tr>
                <th data-sort="number">Price</th>
                <th data-sort="number">Volume</th>
                <th data-sort="string">Location</th>
                <th data-sort="string">Expires</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- Chart Tab -->
      <div class="tab-content" id="chartTab">
        <canvas id="historyChart"></canvas>
      </div>
    </div>
  </main>

  <footer>
    <p>Brought to you by <a href="https://evewho.com/character/2118260155" target="_blank">Erica Romero</a></p>
    <p><a href="#" id="ccp-link">All EVE Related Materials are Property of CCP Games</p>
    <div id="ccp-disclaimer" style="display:none;">
      <p>
        <a href="https://www.eveonline.com/" target="_blank">EVE Online</a> and the EVE logo are the registered trademarks of <a href="http://www.ccpgames.com/" target="_blank">CCP hf</a>. All rights are reserved worldwide. 
        All other trademarks are the property of their respective owners. EVE Online, the EVE logo, EVE and all 
        associated logos and designs are the intellectual property of CCP hf. All artwork, screenshots, characters, 
        vehicles, storylines, world facts or other recognizable features of the intellectual property relating to these 
        trademarks are likewise the intellectual property of CCP hf. CCP hf. has granted permission to this website to use 
        EVE Online and all associated logos and designs for promotional and information purposes on its website but does 
        not endorse, and is not in any way affiliated with this website. CCP is in no way responsible for the content on 
        or functioning of this website, nor can it be liable for any damage arising from the use of this website.
      </p>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src= market.js></script>
  <script>
    // Toggle CCP disclaimer visibility
    document.getElementById("ccp-link").addEventListener("click", (e) => {
      e.preventDefault();
      const disclaimer = document.getElementById("ccp-disclaimer");
      disclaimer.style.display = disclaimer.style.display === "none" ? "block" : "none";
    });
  </script>
  <script>
        // Highlight current page
        const navLinks = document.querySelectorAll('nav a');
        const path = window.location.pathname.split('/').pop();

        navLinks.forEach(link => {
        if (link.getAttribute('href') === path || (path === "" && link.getAttribute('href') === "index.html")) {
            link.classList.add('active');
        } else {
            link.classList.remove('active');
        }
        });

        // Player count (top-right)
        fetch("https://esi.evetech.net/latest/status/")
        .then(res => res.json())
        .then(data => {
            const playerCount = document.getElementById("onlineCounter");
            if (playerCount) playerCount.textContent = `${data.players.toLocaleString()}`;
            playerCount.style.color = "#378937ff";
        })
        .catch(() => {
            const playerCount = document.getElementById("onlineCounter");
            if (playerCount) playerCount.textContent = "Tranquility unreachable";
            playerCount.style.color = "#9f3232ff";
        });
    </script>
    <script>
      function updateEveTime() {
        const now = new Date();
        const hours = String(now.getUTCHours()).padStart(2, "0");
        const minutes = String(now.getUTCMinutes()).padStart(2, "0");
        document.getElementById("eveTime").textContent = `${hours}:${minutes}`;
      }

      updateEveTime();
      setInterval(updateEveTime, 1000);

    </script>
    <script>
      // Tabs
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById(btn.dataset.tab).classList.add('active');
        });
      });

      // Sortable tables
      document.querySelectorAll('.sortable th').forEach(th => {
        th.addEventListener('click', () => {
          const table = th.closest('table');
          const tbody = table.querySelector('tbody');
          const rows = Array.from(tbody.querySelectorAll('tr'));
          const colIndex = Array.from(th.parentNode.children).indexOf(th);
          const type = th.dataset.sort;
          const asc = !th.classList.contains('asc');
          rows.sort((a,b) => {
            const aText = a.children[colIndex].textContent.replace(/,/g,'');
            const bText = b.children[colIndex].textContent.replace(/,/g,'');
            if(type==='number') return asc ? aText-bText : bText-aText;
            return asc ? aText.localeCompare(bText) : bText.localeCompare(aText);
          });
          tbody.innerHTML = '';
          rows.forEach(r=>tbody.appendChild(r));
          th.classList.toggle('asc', asc);
          th.classList.toggle('desc', !asc);
        });
      });
    </script>
</body>
</html>